(function(e){function t(t){for(var r,o,i=t[0],c=t[1],u=t[2],d=0,m=[];d<i.length;d++)o=i[d],a[o]&&m.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(m.length)m.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(r=!1)}r&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},s=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"02c9":function(e,t,n){},"0c2b":function(e,t,n){},1:function(e,t){},2:function(e,t){},"2db7":function(e,t,n){},"2e40":function(e,t,n){},3:function(e,t){},"31f1":function(e,t,n){},4678:function(e,t,n){var r={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function a(e){var t=s(e);return n(t)}function s(e){var t=r[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}a.keys=function(){return Object.keys(r)},a.resolve=s,e.exports=a,a.id="4678"},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-view")},s=[],o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 1000 1000","enable-background":"new 0 0 1000 1000","xml:space":"preserve"}},[n("g",[n("g",{attrs:{transform:"translate(0.000000,511.000000) scale(0.100000,-0.100000)"}},[n("path",{attrs:{d:"M5893.9,4979.4c-128.7-41.4-242.1-111.2-333.7-207.2c-37.1-41.4-325-475.4-641.2-968.3c-314.1-490.7-940-1467.8-1389.3-2170.1c-449.3-702.3-835.3-1310.8-859.3-1354.4c-21.8-43.6-52.3-139.6-65.4-211.5c-56.7-301,122.1-647.8,407.8-793.9c37.1-19.6,250.8-85,477.6-143.9c224.6-61.1,414.4-115.6,418.8-120c6.5-4.4-163.6-652.1-375.1-1435.1c-355.5-1310.8-386-1441.6-388.2-1611.7c0-154.8,8.7-205,56.7-309.7c220.3-475.4,857.1-595.4,1212.6-229C4546-4442.3,7333.3-193.8,7376.9-60.8c26.2,76.3,32.7,157,26.2,285.7c-6.5,148.3-19.6,198.5-82.9,316.2c-76.3,143.9-213.7,272.6-344.6,327.1c-37.1,15.3-257.4,80.7-488.5,144c-231.2,63.2-418.8,122.1-418.8,133c2.2,10.9,183.2,687,401.3,1502.7c390.4,1450.4,396.9,1485.2,388.2,1657.5c-10.9,207.2-72,342.4-215.9,486.3C6450,4981.6,6140.3,5057.9,5893.9,4979.4z M6190.5,4344.8c21.8-19.6,39.2-61.1,39.2-91.6c0-30.5-211.6-846.2-468.9-1810.2c-259.5-964-466.7-1757.9-460.2-1762.2c4.4-4.4,301-87.2,658.7-183.2c359.9-96,682.7-183.2,721.9-196.3c69.8-21.8,93.8-56.7,93.8-133c0-58.9-2763.3-4263.8-2830.9-4309.6c-63.3-41.4-150.5-8.7-167.9,67.6c-8.7,30.5,159.2,693.5,444.9,1764.4c253,942.2,460.2,1727.3,460.2,1744.8c0,19.6-189.7,78.5-647.7,200.7c-357.7,96-680.5,185.4-719.7,200.7c-152.7,61.1-209.4-39.3,1269.3,2270.4c752.4,1173.3,1391.5,2165.7,1419.8,2205C6064,4390.6,6127.3,4401.5,6190.5,4344.8z"}})])])])},i=[],c={},u=c,l=n("2877"),d=Object(l["a"])(u,o,i,!1,null,null,null),m=d.exports;r["a"].component("Bolt",m);var p={},h=p,v=(n("5c0b"),Object(l["a"])(h,a,s,!1,null,null,null)),f=v.exports,g=n("8c4f"),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"play-layout"},[n("router-link",{attrs:{to:"/test"}},[e._v("Home")]),n("br"),n("br"),n(e.page,{tag:"component"})],1)},w=[],k={props:["page"],data:function(){return{show:!0}},methods:{}},x=k,j=Object(l["a"])(x,b,w,!1,null,null,null),C=j.exports,R=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},y=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"play-client"},[n("div",{staticClass:"client"})])}],_={mounted:function(){Silverchat.init({roomId:this.$route.params.socketRoomId,selector:".client"})}},S=_,O=Object(l["a"])(S,R,y,!1,null,"046dacbb",null),N=O.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isDataReady?n("section",[n("div",[e._v("ADMIN - Room is "+e._s(e.room.name))]),n("h3",[e._v("Waiting clients:")]),e._l(e.convos,function(t){return n("div",[e._v(e._s(t.clientId)+" "+e._s(t.state)+" "+e._s(t.adminId))])}),n("h3",[e._v("Connected admins:")]),e._l(e.room.admins,function(t){return n("div",[e._v(e._s(t))])}),n("br"),n("br"),n("br"),n("br"),n("br"),null==e.store.connectedRoom?n("div",[n("p",[e._v("You haven't joined a room")]),n("button",{on:{click:function(t){return e.joinRoom()}}},[e._v("Join Room")])]):n("div",[n("p",[e._v("You have joined the room "+e._s(e.store.connectedRoom.name))]),n("button",{on:{click:function(t){return e.leaveRoom()}}},[e._v("Leave Room")]),null==e.store.connectedConvo?n("div",[n("p",[e._v("Not having any conversation")]),e.waitingConvos.length>0?n("div",[n("p",[e._v("Someone is Waiting !")]),n("button",{on:{click:function(t){e.recordVideo=!1,e.nextConvo()}}},[e._v("Join With CALL")]),n("button",{on:{click:function(t){e.recordVideo=!0,e.nextConvo()}}},[e._v("Join With VIDEO")])]):e._e()]):n("div",[n("video",{attrs:{muted:"muted",playsinline:"playsinline"},domProps:{muted:!0}}),n("p",[e._v("You are having conversation with: "+e._s(e.store.connectedConvo.clientId))]),n("button",{on:{click:function(t){return e.endConvo()}}},[e._v("End Conversation")]),0==e.hasAcceptedCall?n("div",[n("button",{on:{click:function(t){e.recordVideo=!1,e.answerCall()}}},[e._v("Reconnect to CALL !")]),n("button",{on:{click:function(t){e.recordVideo=!0,e.answerCall()}}},[e._v("Reconnect to VIDEO !")])]):n("div",[n("p",[e._v(e._s(e.recordVideo?"Your Camera is ON":"Your Camera is OFF"))]),n("button",{on:{click:function(t){e.recordVideo=!e.recordVideo,e.updateUserMediaStream()}}},[e._v(e._s(e.recordVideo?"Turn Video OFF":"Turn Video ON"))])])])])],2):e._e()},I=[],E=n("6ee6"),P=n("f499"),A=n.n(P),D=n("768b"),M=n("795b"),V=n.n(M),$=(n("ac6a"),n("06db"),n("5df3"),n("96cf"),n("3b8d")),U=n("bc3a"),L=n.n(U),z=n("8ded"),F=n.n(z),G="https://api.silverchat.co/",q=n("8055")(G+"play",{rejectUnauthorized:!1});function W(){return q.id}function Y(e,t){return J.apply(this,arguments)}function J(){return J=Object($["a"])(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.a.post(G+t,n,{headers:{Authorization:F.a.get("authToken")}});case 3:return r=e.sent,e.abrupt("return",r.data);case 7:throw e.prev=7,e.t0=e["catch"](0),console.log("e: ",e.t0),401===e.t0.response.status&&(F.a.remove("authToken"),window.location="/login",console.log("path: "+t),console.log("data: "+n)),e.t0;case 12:return e.abrupt("return",res.data);case 13:case"end":return e.stop()}},e,null,[[0,7]])})),J.apply(this,arguments)}function H(e,t){return B.apply(this,arguments)}function B(){return B=Object($["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new V.a(function(e){q.emit(t,n,F.a.get("authToken"),function(t){e(t)})}));case 1:case"end":return e.stop()}},e)})),B.apply(this,arguments)}function K(e,t){q.on(e,t)}var Q=n("051a"),X=n.n(Q),Z=(n("d093"),n("c1df")),ee=n.n(Z),te=null,ne={iceServers:[{urls:["stun:ss-turn1.xirsys.com"]},{urls:"turn:104.248.158.23:3478",credential:"gsFu3kkpFB2aMWih",username:"Silverchat"}]},re=null,ae={data:function(){return{isDataReady:!1,newRoomName:"",room:null,convos:[],incomingSignal:null,recordVideo:!1,recordAudio:!0,socketConnectedToRoom:!1,socketConnectedToConvo:!1,isConnectionEstablished:!1,hasAcceptedCall:!1,lastClientSeed:null,connectedSeed:null,mySeed:null,clientSocketId:null,mySignals:[],lastPeerSetupDate:null}},created:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.logAsGuestIf();case 2:return this.socketSetup(),e.next=5,this.fetchAllData();case 5:return e.next=7,V.a.all([this.socketConnectToRoom(),this.socketConnectToConvo()]);case 7:this.isDataReady=!0;case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{fetchAllData:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n,r,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,V.a.all([this.storeConnectedRoom(),Y("admin/get-room",{socketRoomId:this.socketRoomId})]);case 2:t=e.sent,n=Object(D["a"])(t,2),n[0],r=n[1],a=r.room,s=r.convos,this.room=a,this.convos=s;case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),socketConnectToRoom:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(null==this.store.connectedRoom||0!=this.socketConnectedToRoom){e.next=3;break}return this.socketConnectedToRoom=!0,e.abrupt("return",H("admin/join-room",{}));case 3:return e.abrupt("return",V.a.resolve());case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),socketConnectToConvo:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(null==this.store.connectedConvo||0!=this.socketConnectedToConvo){e.next=3;break}return this.socketConnectedToConvo=!0,e.abrupt("return",H("setup-convos",{}));case 3:return e.abrupt("return",V.a.resolve());case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),simplePeerSetup:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!(null==this.lastPeerSetupDate||ee()()-this.lastPeerSetupDate>2e3)){e.next=4;break}this.lastPeerSetupDate=ee()(),e.next=5;break;case 4:return e.abrupt("return");case 5:return this.mySeed=Math.round(1e6*Math.random()),console.log("My Seed: ",this.mySeed),this.lastClientSeed=null,this.connectedSeed=null,this.mySignals=[],this.isConnectionEstablished=!1,null!=te&&te.destroy(),e.prev=12,e.next=15,navigator.mediaDevices.getUserMedia({video:this.recordVideo,audio:this.recordAudio});case 15:re=e.sent,e.next=24;break;case 18:return e.prev=18,e.t0=e["catch"](12),console.log("e: ",e.t0),e.next=23,navigator.mediaDevices.getUserMedia({video:!1,audio:!0});case 23:re=e.sent;case 24:te=new X.a({initiator:!0,trickle:!0,stream:re,config:ne}),te.on("stream",function(e){console.log("receiving the vid");var t=document.querySelector("video");"srcObject"in t?t.srcObject=e:t.src=window.URL.createObjectURL(e),t.play(),t.muted=!1}),te.on("error",function(e){return console.log("peer error: ",e)}),te.on("signal",function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("MY SIGNAL:  ",A()(n)),t.mySignals.push(n),1!=t.socketConnectedToConvo){e.next=5;break}return e.next=5,H("transmit-signal",{signal:n,seed:t.mySeed,senderSocketId:W()});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),te.on("connect",function(){console.log("I'M CONNECTED !")}),te.on("close",Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("CONNECTION WAS CLOSED !!"),e.next=3,t.simplePeerSetup();case 3:case"end":return e.stop()}},e)})));case 30:case"end":return e.stop()}},e,this,[[12,18]])}));function t(){return e.apply(this,arguments)}return t}(),updateUserMediaStream:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:try{te.removeStream(re)}catch(n){re=null}finally{setTimeout(Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:t.recordVideo,audio:t.recordAudio});case 2:re=e.sent,console.log("new stream: ",re),e.prev=4,te.addStream(re),e.next=13;break;case 8:return e.prev=8,e.t0=e["catch"](4),e.next=12,t.simplePeerSetup();case 12:console.log("RESETING LAST RESORT: ");case 13:case"end":return e.stop()}},e,null,[[4,8]])})),10)}case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}(),emitStoredSignals:function(){if(console.log("emit my stored signals: ",this.mySignals.length),0!=this.mySignals.length)for(var e=0;e<this.mySignals.length;++e){var t=this.mySignals[e];H("transmit-signal",{signal:t,seed:this.mySeed,senderSocketId:W()})}},socketSetup:function(){var e=this;K("admin/request-for-signal",function(){var t=Object($["a"])(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(Object(E["a"])(n),console.log("receiving request-for-signal"),1!=e.isConnectionEstablished){t.next=8;break}return console.log("connection already established, reconstructing peer"),t.next=6,e.simplePeerSetup();case 6:t.next=9;break;case 8:e.emitStoredSignals();case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),K("admin/emit-signal",function(){var t=Object($["a"])(regeneratorRuntime.mark(function t(n){var r,a,s,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r=n.signal,a=n.seed,s=n.returnSeed,o=n.senderSocketId,console.log("returnSeed: ",s),s==e.mySeed){t.next=5;break}return console.log("Unknown return Seed"),t.abrupt("return");case 5:if(console.log("OTHER SIGNAL: ",r),console.log("seed: ",a),console.log("this.connectedSeed: ",e.connectedSeed),e.lastClientSeed=a,e.clientSocketId=o,e.connectedSeed!=a){t.next=15;break}console.log("CONCAT NEW SIGNAL"),te.signal(r),t.next=24;break;case 15:if(1!=e.isConnectionEstablished){t.next=21;break}return console.log("connection already established, reconstructing peer"),t.next=19,e.simplePeerSetup();case 19:t.next=24;break;case 21:console.log("FIRST SIGNAL"),e.incomingSignal=r,e.tryConnectIncomingSignal();case 24:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),K("admin/notify-new-convo",function(t){var n=t.convo;console.log("NEW CONVO: ",n),e.convos.push(n)}),K("user-disconnected",function(e){var t=e.id;console.log("THIS SOCKET ID DISCONNECTED: ",t)})},tryConnectIncomingSignal:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:1==this.hasAcceptedCall&&null!=this.incomingSignal&&(te.signal(this.incomingSignal),this.isConnectionEstablished=!0,this.incomingSignal=null,this.connectedSeed=this.lastClientSeed);case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),joinRoom:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/join-room",{socketRoomId:this.socketRoomId});case 2:return e.next=4,this.fetchAllData();case 4:return e.next=6,this.socketConnectToRoom();case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),endConvo:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/end-convo",{});case 2:location.reload();case 3:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}(),nextConvo:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.simplePeerSetup();case 2:return e.next=4,Y("admin/next-convo",{});case 4:return e.next=6,this.fetchAllData();case 6:return this.hasAcceptedCall=!0,e.next=9,this.socketConnectToConvo();case 9:this.emitStoredSignals();case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),leaveRoom:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/leave-room",{});case 2:return e.next=4,this.fetchAllData();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),answerCall:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.simplePeerSetup();case 2:this.hasAcceptedCall=!0;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},computed:{socketRoomId:function(){return this.$route.params.socketRoomId},waitingConvos:function(){return this.convos.filter(function(e){return"waiting"==e.state})}}},se=ae,oe=Object(l["a"])(se,T,I,!1,null,"ac2d59e6",null),ie=oe.exports,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("WebSocket Monitor")])},ue=[],le=(n("28a5"),{created:function(){console.log("suo bro");var e="https://".concat(location.host.split(":")[0],":4000/"),t=n("8055")(e+"ws-monitor",{rejectUnauthorized:!1});t.on("snapshot",function(e){console.log("snapshot data: ",e)})}}),de=le,me=Object(l["a"])(de,ce,ue,!1,null,"00d482f8",null),pe=me.exports,he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isDataReady?n("div",{staticClass:"verify"},[n("div",{staticClass:"text"},[n("b",[e._v(e._s(e.user.firstName))]),e._v(", you are invited to join "),n("b",[e._v(e._s(null!=e.team?e.team.name:"Silverchat Admin"))]),n("br"),null!=e.user.role?n("span",[e._v("Role: "+e._s(e.user.role)+" "),n("br")]):e._e()]),n("div",{staticClass:"text"},[e._v("Please create your password")]),n("form",{on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),n("label",{attrs:{for:"password"}},[e._v("Password")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.repeatPassword,expression:"repeatPassword"}],attrs:{type:"password",id:"repeatPassword"},domProps:{value:e.repeatPassword},on:{input:function(t){t.target.composing||(e.repeatPassword=t.target.value)}}}),n("label",{attrs:{for:"repeatPassword"}},[e._v("Repeat Password")]),n("button",{attrs:{type:"submit"}},[e._v("Submit")])])]):null!=e.errorMessage?n("div",{staticClass:"error"},[e._v(e._s(e.errorMessage))]):e._e()},ve=[],fe={data:function(){return{user:null,team:null,isDataReady:!1,password:"",repeatPassword:"",errorMessage:null}},created:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y("get-info-from-verif-token",{verificationToken:this.$route.params.verificationToken});case 3:t=e.sent,n=t.user,r=t.team,this.user=n,this.team=r,this.isDataReady=!0,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),this.errorMessage=e.t0.response.data;case 14:case"end":return e.stop()}},e,this,[[0,11]])}));function t(){return e.apply(this,arguments)}return t}(),methods:{submit:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.password==this.repeatPassword&&null!=this.password){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Y("verify",{verificationToken:this.$route.params.verificationToken,password:this.password});case 4:return e.next=6,Y("login",{email:this.user.email,password:this.password});case 6:t=e.sent,n=t.authToken,console.log("authToken: ",n),F.a.set("authToken",n),this.$router.push("/");case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},ge=fe,be=(n("b285"),Object(l["a"])(ge,he,ve,!1,null,"327506f7",null)),we=be.exports,ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[e._v("sup brah"),n("div",{staticClass:"create"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newRoomName,expression:"newRoomName"}],domProps:{value:e.newRoomName},on:{input:function(t){t.target.composing||(e.newRoomName=t.target.value)}}}),n("button",{on:{click:function(t){return e.clickCreateNewRoom()}}},[e._v("Create New")])]),n("div",{staticClass:"list"},e._l(e.rooms,function(t){return n("div",{staticClass:"item"},[n("router-link",{attrs:{to:"play/"+t.socketRoomId+"/client/preview"}},[e._v(e._s(t.socketRoomId))]),e._v(" "),n("router-link",{attrs:{to:"play/"+t.socketRoomId+"/admin"}},[e._v("_@")])],1)}),0)])},xe=[],je={data:function(){return{newRoomName:"",rooms:[]}},created:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.logAsGuestIf();case 2:return e.next=4,this.fetchAllData();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{clickCreateNewRoom:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("create-room",{name:this.newRoomName});case 2:return e.next=4,this.fetchAllData();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),fetchAllData:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("list-rooms");case 2:t=e.sent,n=t.rooms,this.rooms=n;case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},Ce=je,Re=Object(l["a"])(Ce,ke,xe,!1,null,"3b7533c6",null),ye=Re.exports,_e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isDataReady?n("div",{staticClass:"admin-layout"},[n("div",[e._v("Admin Space - Welcome "+e._s(e.store.user.firstName)),n("div",{staticClass:"nav-item",on:{click:e.logout}},[e._v("Logout")]),n(e.page,{tag:"component"})],1)]):e._e()},Se=[],Oe={props:["page"],data:function(){return{isDataReady:!1}},created:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.storeMyProfile();case 2:console.log("user: ",this.store.user),null!=this.store.user&&1==this.store.user.isAdmin||this.$router.push("/login"),this.isDataReady=!0;case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{logout:function(){this.logoutUser()}}},Ne=Oe,Te=(n("608a"),Object(l["a"])(Ne,_e,Se,!1,null,"18464d37",null)),Ie=Te.exports,Ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dashboard"},[n("h2",[e._v("Teams")]),n("div",{staticClass:"teams"},e._l(e.teams,function(t){return n("div",{staticClass:"team"},[n("router-link",{attrs:{to:"/admin/teams/"+t._id}},[e._v(e._s(t.name))])],1)}),0),n("input",{directives:[{name:"model",rawName:"v-model",value:e.teamName,expression:"teamName"}],attrs:{placeholder:"name"},domProps:{value:e.teamName},on:{input:function(t){t.target.composing||(e.teamName=t.target.value)}}}),n("button",{on:{click:e.createTeam}},[e._v("Create Team")]),n("h2",[e._v("Admins")]),n("div",{staticClass:"admins"},e._l(e.admins,function(t){return n("div",{staticClass:"admin"},[e._v(e._s(t.firstName)+" "+e._s(t.lastName)+" "+e._s(t.email)+" "+e._s(t.isVerified?"":"-UNVERIFIED-")),n("button",{on:{click:function(n){return e.deleteUser(t)}}},[e._v("delete")])])}),0),n("h3",[e._v("Invite new Admin")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{placeholder:"email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.firstName,expression:"firstName"}],attrs:{placeholder:"first name"},domProps:{value:e.firstName},on:{input:function(t){t.target.composing||(e.firstName=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.lastName,expression:"lastName"}],attrs:{placeholder:"last name"},domProps:{value:e.lastName},on:{input:function(t){t.target.composing||(e.lastName=t.target.value)}}}),n("button",{on:{click:e.inviteAdmin}},[e._v("Invite Admin")])])},Pe=[],Ae={data:function(){return{email:"",firstName:"",lastName:"",admins:[],teamName:"",teams:[]}},created:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,V.a.all([this.getAdmins(),this.getTeams()]);case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{inviteAdmin:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/invite-admin",{email:this.email,firstName:this.firstName,lastName:this.lastName});case 2:return this.email="",this.firstName="",this.lastName="",e.next=7,this.getAdmins();case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),createTeam:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("create-team",{name:this.teamName});case 2:return this.teamName="",e.next=5,this.getTeams();case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getAdmins:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/get-admins");case 2:t=e.sent,n=t.users,this.admins=n;case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getTeams:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/get-teams");case 2:t=e.sent,n=t.teams,this.teams=n;case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),deleteUser:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("Gael"!=t.firstName&&"Julius"!=t.firstName){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Y("admin/delete-user",{id:t._id});case 4:return e.next=6,this.getAdmins();case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},De=Ae,Me=(n("a6f0"),Object(l["a"])(De,Ee,Pe,!1,null,"60b580f0",null)),Ve=Me.exports,$e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isDataReady?n("div",{staticClass:"team"},[n("h2",[e._v(e._s(e.team.name))]),n("div",{staticClass:"users"},e._l(e.users,function(t){return n("div",{staticClass:"user"},[n("b",[e._v(e._s(t.firstName)+" "+e._s(t.lastName))]),e._v(" - "+e._s(t.email))])}),0),n("h3",[e._v("Invite new Member")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{placeholder:"email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.firstName,expression:"firstName"}],attrs:{placeholder:"first name"},domProps:{value:e.firstName},on:{input:function(t){t.target.composing||(e.firstName=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.lastName,expression:"lastName"}],attrs:{placeholder:"last name"},domProps:{value:e.lastName},on:{input:function(t){t.target.composing||(e.lastName=t.target.value)}}}),n("br"),n("input",{directives:[{name:"model",rawName:"v-model",value:e.role,expression:"role"}],attrs:{type:"radio",id:"member",value:"member"},domProps:{checked:e._q(e.role,"member")},on:{change:function(t){e.role="member"}}}),n("label",{attrs:{for:"member"}},[e._v("Member")]),n("br"),n("input",{directives:[{name:"model",rawName:"v-model",value:e.role,expression:"role"}],attrs:{type:"radio",id:"manager",value:"manager"},domProps:{checked:e._q(e.role,"manager")},on:{change:function(t){e.role="manager"}}}),n("label",{attrs:{for:"manager"}},[e._v("Manager")]),n("br"),n("input",{directives:[{name:"model",rawName:"v-model",value:e.role,expression:"role"}],attrs:{type:"radio",id:"owner",value:"owner"},domProps:{checked:e._q(e.role,"owner")},on:{change:function(t){e.role="owner"}}}),n("label",{attrs:{for:"owner"}},[e._v("Owner")]),n("br"),n("br"),n("button",{on:{click:e.inviteMember}},[e._v("Invite Member")])]):e._e()},Ue=[],Le={data:function(){return{team:null,users:[],isDataReady:!1,email:"",firstName:"",lastName:"",role:""}},created:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,V.a.all([this.getTeam()]);case 2:this.isDataReady=!0;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{getTeam:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/get-team",{id:this.$route.params.id});case 2:t=e.sent,n=t.team,r=t.users,this.team=n,this.users=r;case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),inviteMember:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/invite-member",{email:this.email,firstName:this.firstName,lastName:this.lastName,role:this.role,teamId:this.$route.params.id});case 2:return t=e.sent,t.team,t.users,this.email="",this.firstName="",this.lastName="",this.role="",e.next=11,this.getTeam();case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},ze=Le,Fe=Object(l["a"])(ze,$e,Ue,!1,null,"25aac882",null),Ge=Fe.exports,qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"credentials-layout"},[n("div",{staticClass:"top"},[n("div",{staticClass:"logo"},[e._v("Silverchat")]),n("div",{staticClass:"content"},[n(e.page,{tag:"component"})],1)]),n("div",{staticClass:"bottom"})])},We=[],Ye={props:["page"],data:function(){return{show:!0}},methods:{}},Je=Ye,He=(n("7609"),Object(l["a"])(Je,qe,We,!1,null,"843d3de6",null)),Be=He.exports,Ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("div",{staticClass:"text"},[e._v("Welcome back !")]),n("form",{on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{id:"email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),n("label",{attrs:{for:"email"}},[e._v("Email")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),n("label",{attrs:{for:"password"}},[e._v("Password")]),n("button",{attrs:{type:"submit"}},[e._v("Login")]),null!=e.errorMsg?n("div",{staticClass:"error"},[e._v(e._s(e.errorMsg))]):e._e()])])},Qe=[],Xe={data:function(){return{email:"",password:"",errorMsg:null}},methods:{submit:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""!=this.password&&""!=this.email){e.next=3;break}return console.log("invalid"),e.abrupt("return");case 3:return e.prev=3,e.next=6,Y("login",{email:this.email,password:this.password});case 6:t=e.sent,n=t.authToken,console.log("authToken: ",n),F.a.set("authToken",n),this.$router.push("/"),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](3),this.errorMsg="Invalid email/password combination";case 16:case"end":return e.stop()}},e,this,[[3,13]])}));function t(){return e.apply(this,arguments)}return t}()}},Ze=Xe,et=(n("ee6b"),Object(l["a"])(Ze,Ke,Qe,!1,null,"21dbbccf",null)),tt=et.exports,nt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isDataReady?n("div",{staticClass:"client-layout"},[n("div",{staticClass:"header"},[n("div",{staticClass:"team-name"},[e._v(e._s(e.store.team.name))]),n("div",{staticClass:"user-name"},[e._v("Hi, "+e._s(e.store.user.firstName))])]),n("div",{staticClass:"nav-bar"},[n("router-link",{staticClass:"nav-item",attrs:{to:"/"},on:{click:e.logout}},[e._v("Portal")]),n("router-link",{staticClass:"nav-item",attrs:{to:"/setup"},on:{click:e.logout}},[e._v("Setup")]),n("div",{staticClass:"nav-item last",on:{click:e.logout}},[e._v("Log out")])],1),n("div",{staticClass:"content"},[n(e.page,{tag:"component"})],1)]):e._e()},rt=[],at={props:["page"],data:function(){return{isDataReady:!1}},created:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.storeMyProfile();case 2:console.log("user: ",this.store.user),null==this.store.user||1==this.store.user.isGuest?this.$router.push("/login"):null==this.store.team&&1==this.store.user.isAdmin&&this.$router.push("/admin"),this.isDataReady=!0;case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{logout:function(){this.logoutUser()}}},st=at,ot=(n("6cd9"),Object(l["a"])(st,nt,rt,!1,null,"dfc6d62c",null)),it=ot.exports,ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dashboard"},[e._v("Dashboard client hello")])},ut=[],lt={},dt=lt,mt=Object(l["a"])(dt,ct,ut,!1,null,null,null),pt=(mt.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"portal"},[n("portal",{attrs:{socketRoomId:e.store.room.socketRoomId}})],1)}),ht=[],vt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isDataReady?n("div",{staticClass:"c-portal"},[n("div",{staticClass:"top-section"},[n("a",{attrs:{href:e.previewLink,target:"_blank"}},[e._v("Preview")]),n("div",{staticClass:"square-counter waiting-convo-nb"},[e._v(e._s(e.waitingConvos.length))]),n("div",{staticClass:"square-counter total-convo-nb"},[e._v(e._s(this.totalConvos))])]),n("div",{staticClass:"container-flex"},[n("div",{staticClass:"status-panel"},[null==e.store.connectedRoom?[n("div",{staticClass:"text"},[e._v("You are offline")]),n("button",{staticClass:"green",on:{click:function(t){return e.joinRoom()}}},[e._v("Join Room")])]:null==e.store.connectedConvo?[n("div",{staticClass:"text green"},[e._v("You are online")]),n("button",{staticClass:"grey",on:{click:function(t){return e.leaveRoom()}}},[e._v("Leave Room")])]:[n("video",{staticClass:"client-video",attrs:{muted:"muted",playsinline:"playsinline"},domProps:{muted:!0}}),n("div",{staticClass:"text"},[e._v("You are connected to a visitor")]),n("button",{staticClass:"grey",on:{click:function(t){return e.endConvo()}}},[e._v("End Conversation")])]],2),n("div",{staticClass:"action-panel"},[null!=e.store.connectedRoom&&null==e.store.connectedConvo&&e.waitingConvos.length>0?[0==e.isFirstContact?[e._m(0),n("button",{on:{click:function(t){e.recordVideo=!0,e.nextConvo()}}},[e._v("Video Call")]),n("button",{staticClass:"border green",on:{click:function(t){e.recordVideo=!1,e.nextConvo()}}},[e._v("Voice Only")])]:[n("div",{staticClass:"big-text"},[e._v("Connecting...")])]]:null!=e.store.connectedConvo&&1==e.hasAcceptedCall?[n("div",{staticClass:"text"},[e._v(e._s(e.recordVideo?"Your Camera is ON":"Your Camera is OFF"))]),e.recordVideo?[n("button",{staticClass:"border grey",on:{click:function(t){e.recordVideo=!e.recordVideo,e.updateUserMediaStream()}}},[e._v("Turn Video OFF")])]:[n("button",{staticClass:"border green",on:{click:function(t){e.recordVideo=!e.recordVideo,e.updateUserMediaStream()}}},[e._v("Turn Video ON")])]]:null!=e.store.connectedConvo&&0==e.hasAcceptedCall?[0==e.isFirstContact?[n("div",{staticClass:"text"},[e._v("Please reconnect")]),n("button",{on:{click:function(t){e.recordVideo=!0,e.answerCall()}}},[e._v("Reconnect with Video")]),n("button",{staticClass:"border green",on:{click:function(t){e.recordVideo=!1,e.answerCall()}}},[e._v("Reconnect with Voice")])]:[n("div",{staticClass:"big-text"},[e._v("Connecting...")])]]:[0==e.waitingConvos.length?n("div",{staticClass:"big-text"},[e._v("No callers")]):n("div",{staticClass:"big-text"},[n("b",[e._v("Someone is calling")])])]],2)])]):e._e()},ft=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text"},[n("b",[e._v("A visitor is calling")])])}],gt=n("d404"),bt=n.n(gt);window.webNotification=bt.a;var wt=null,kt={iceServers:[{urls:["stun:ss-turn1.xirsys.com"]},{urls:"turn:104.248.158.23:3478",credential:"gsFu3kkpFB2aMWih",username:"Silverchat"}]},xt=null,jt=Math.round(1e6*Math.random()),Ct={props:["socketRoomId"],data:function(){return{isFirstContact:!1,isDataReady:!1,newRoomName:"",room:null,convos:[],incomingSignal:null,recordVideo:!1,recordAudio:!0,socketConnectedToRoom:!1,socketConnectedToConvo:!1,isConnectionEstablished:!1,hasAcceptedCall:!1,lastClientSeed:null,connectedSeed:null,mySeed:null,clientSocketId:null,mySignals:[],lastPeerSetupDate:null,totalConvos:null}},created:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.logAsGuestIf();case 2:return this.socketSetup(),e.next=5,this.fetchAllData();case 5:return e.next=7,V.a.all([this.socketConnectToRoom(),this.socketConnectToConvo()]);case 7:return e.next=9,this.getStats();case 9:this.isDataReady=!0;case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{fetchAllData:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n,r,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,V.a.all([this.storeConnectedRoom(),Y("admin/get-room",{socketRoomId:this.socketRoomId})]);case 2:t=e.sent,n=Object(D["a"])(t,2),n[0],r=n[1],a=r.room,s=r.convos,this.room=a,this.convos=s;case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),socketConnectToRoom:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(null==this.store.connectedRoom||0!=this.socketConnectedToRoom){e.next=4;break}return bt.a.requestPermission(),this.socketConnectedToRoom=!0,e.abrupt("return",H("admin/join-room",{}));case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),socketConnectToConvo:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(null==this.store.connectedConvo||0!=this.socketConnectedToConvo){e.next=3;break}return this.socketConnectedToConvo=!0,e.abrupt("return",H("setup-convos",{}));case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),simplePeerSetup:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!(null==this.lastPeerSetupDate||ee()()-this.lastPeerSetupDate>2e3)){e.next=4;break}this.lastPeerSetupDate=ee()(),e.next=5;break;case 4:return e.abrupt("return");case 5:return this.mySeed=Math.round(1e6*Math.random()),console.log("My Seed: ",this.mySeed),this.lastClientSeed=null,this.connectedSeed=null,this.mySignals=[],this.isConnectionEstablished=!1,null!=wt&&wt.destroy(),e.prev=12,e.next=15,navigator.mediaDevices.getUserMedia({video:this.recordVideo,audio:this.recordAudio});case 15:xt=e.sent,e.next=24;break;case 18:return e.prev=18,e.t0=e["catch"](12),console.log("e: ",e.t0),e.next=23,navigator.mediaDevices.getUserMedia({video:!1,audio:!0});case 23:xt=e.sent;case 24:wt=new X.a({initiator:!0,trickle:!0,stream:xt,config:kt}),wt.on("stream",function(e){console.log("receiving the vid");var t=document.querySelector("video");"srcObject"in t?t.srcObject=e:t.src=window.URL.createObjectURL(e),t.play(),t.muted=!1}),wt.on("error",function(e){return console.log("peer error: ",e)}),wt.on("signal",function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("MY SIGNAL:  ",A()(n)),t.mySignals.push(n),1!=t.socketConnectedToConvo){e.next=5;break}return e.next=5,H("transmit-signal",{signal:n,seed:t.mySeed,senderSocketId:W()});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),wt.on("connect",function(){console.log("I'M CONNECTED !")}),wt.on("close",Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("CONNECTION WAS CLOSED !!"),e.next=3,t.simplePeerSetup();case 3:case"end":return e.stop()}},e)})));case 30:case"end":return e.stop()}},e,this,[[12,18]])}));function t(){return e.apply(this,arguments)}return t}(),updateUserMediaStream:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:try{wt.removeStream(xt)}catch(n){xt=null}finally{setTimeout(Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:t.recordVideo,audio:t.recordAudio});case 2:xt=e.sent,console.log("new stream: ",xt),e.prev=4,wt.addStream(xt),e.next=13;break;case 8:return e.prev=8,e.t0=e["catch"](4),e.next=12,t.simplePeerSetup();case 12:console.log("RESETING LAST RESORT: ");case 13:case"end":return e.stop()}},e,null,[[4,8]])})),10)}case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}(),emitStoredSignals:function(){if(console.log("emit my stored signals: ",this.mySignals.length),0!=this.mySignals.length)for(var e=0;e<this.mySignals.length;++e){var t=this.mySignals[e];H("transmit-signal",{signal:t,seed:this.mySeed,senderSocketId:W()})}},socketSetup:function(){var e=this;K("admin/request-for-signal",function(){var t=Object($["a"])(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(Object(E["a"])(n),console.log("receiving request-for-signal"),1!=e.isConnectionEstablished){t.next=8;break}return console.log("connection already established, reconstructing peer"),t.next=6,e.simplePeerSetup();case 6:t.next=9;break;case 8:e.emitStoredSignals();case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),K("admin/emit-signal",function(){var t=Object($["a"])(regeneratorRuntime.mark(function t(n){var r,a,s,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r=n.signal,a=n.seed,s=n.returnSeed,o=n.senderSocketId,console.log("returnSeed: ",s),s==e.mySeed){t.next=5;break}return console.log("Unknown return Seed"),t.abrupt("return");case 5:if(console.log("OTHER SIGNAL: ",r),console.log("seed: ",a),console.log("this.connectedSeed: ",e.connectedSeed),e.lastClientSeed=a,e.clientSocketId=o,e.connectedSeed!=a){t.next=15;break}console.log("CONCAT NEW SIGNAL"),wt.signal(r),t.next=24;break;case 15:if(1!=e.isConnectionEstablished){t.next=21;break}return console.log("connection already established, reconstructing peer"),t.next=19,e.simplePeerSetup();case 19:t.next=24;break;case 21:console.log("FIRST SIGNAL"),e.incomingSignal=r,e.tryConnectIncomingSignal();case 24:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),K("admin/notify-new-convo",function(){var t=Object($["a"])(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return r=n.convo,console.log("NEW CONVO: ",r),e.convos.push(r),t.next=5,e.getStats();case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),K("user-disconnected",function(e){var t=e.id;console.log("THIS SOCKET ID DISCONNECTED: ",t)})},tryConnectIncomingSignal:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:1==this.hasAcceptedCall&&null!=this.incomingSignal&&(wt.signal(this.incomingSignal),this.isConnectionEstablished=!0,this.incomingSignal=null,this.connectedSeed=this.lastClientSeed);case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),joinRoom:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/join-room",{socketRoomId:this.socketRoomId});case 2:return e.next=4,this.fetchAllData();case 4:return e.next=6,this.socketConnectToRoom();case 6:bt.a.requestPermission();case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),endConvo:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/end-convo",{});case 2:location.reload();case 3:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}(),nextConvo:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.isFirstContact=!0,e.next=3,this.simplePeerSetup();case 3:return e.next=5,Y("admin/next-convo",{});case 5:return e.next=7,this.fetchAllData();case 7:return this.hasAcceptedCall=!0,e.next=10,this.socketConnectToConvo();case 10:this.emitStoredSignals();case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),leaveRoom:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("admin/leave-room",{});case 2:return e.next=4,this.fetchAllData();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),answerCall:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.isFirstContact=!0,e.next=3,this.simplePeerSetup();case 3:this.hasAcceptedCall=!0;case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getStats:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("get-room-stats",{roomId:this.room._id});case 2:t=e.sent,n=t.totalConvos,this.totalConvos=n;case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},computed:{waitingConvos:function(){var e=this.convos.filter(function(e){return"waiting"==e.state});if(e.length>0)try{bt.a.showNotification("Someone calling...",{body:"".concat(e.length," ").concat(1==e.length?"visitor":"visitors"," sent a request to connect"),tag:"".concat(jt,"/").concat(e.length),vibrate:[100,160,220,320]})}catch(t){}return e},previewLink:function(){return"https://client.silverchat.co/?id="+this.room.socketRoomId}}},Rt=Ct,yt=(n("5efa"),Object(l["a"])(Rt,vt,ft,!1,null,"fb0de590",null)),_t=yt.exports,St={components:{portal:_t}},Ot=St,Nt=(n("ba23"),Object(l["a"])(Ot,pt,ht,!1,null,null,null)),Tt=Nt.exports,It=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"setup"},[n("div",{staticClass:"box"},[e._v(e._s(e.codeContent))]),n("div",{staticClass:"instruction"},[n("b",[e._v(e._s(e.instruction))])]),e._m(0),n("div",{staticClass:"instruction"},[e._v("Example: "),n("b",[e._v(e._s(e.example))])])])},Et=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"instruction"},[e._v("It will replace the html element that has the class: "),n("b",[e._v(".silverchat-location")])])}];function Pt(e){return'\n    <script type="text/javascript">\n      Silverchat={init(d){this.d = d;}}\n    <\/script>\n    <script type="text/javascript">\n      Silverchat.init({roomId: "'.concat(e,'", selector: ".silverchat-location"});\n    <\/script>\n    <script src="').concat("https://client.silverchat.co/",'silverchat-client.js" defer><\/script>\n  ')}function At(){return"Paste this code inside the </head> or </body> tag"}function Dt(){return'<div class="silverchat-location"></div>'}var Mt={data:function(){return{}},computed:{codeContent:function(){return Pt(this.store.room.socketRoomId)},instruction:function(){return At()},example:function(){return Dt()}}},Vt=Mt,$t=(n("f0bc"),Object(l["a"])(Vt,It,Et,!1,null,null,null)),Ut=$t.exports;r["a"].use(g["a"]);var Lt=new g["a"]({mode:"history",base:"/",routes:[{path:"/",component:it,props:{page:Tt}},{path:"/setup",component:it,props:{page:Ut}},{path:"/login",component:Be,props:{page:tt}},{path:"/verify/:verificationToken",component:Be,props:{page:we}},{path:"/admin",component:Ie,props:{page:Ve}},{path:"/admin/teams/:id",component:Ie,props:{page:Ge}},{path:"/test",redirect:"/test/rooms"},{path:"/test/rooms",component:C,props:{page:ye}},{path:"/test/play/:socketRoomId/client",component:N},{path:"/test/play/:socketRoomId/client/preview",component:C,props:{page:N}},{path:"/test/play/:socketRoomId/admin",component:C,props:{page:ie}},{path:"/websocket-monitor",component:pe}]}),zt={user:null,team:null,connectedConvo:null,connectedRoom:null};r["a"].mixin({data:function(){return{store:zt}},methods:{storeConnectedRoom:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y("get-current-convo",{});case 2:t=e.sent,null!=t.message?(console.log(t.message),this.store.connectedRoom=null,this.store.connectedConvo=null):(this.store.connectedRoom=t.room,this.store.connectedConvo=t.convo);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),logAsGuestIf:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(null==F.a.get("authToken")){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Y("log-as-guest");case 4:return t=e.sent,n=t.authToken,F.a.set("authToken",n),e.next=9,this.storeMyProfile();case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),storeMyProfile:function(){var e=Object($["a"])(regeneratorRuntime.mark(function e(){var t,n,r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,null==F.a.get("authToken")){e.next=12;break}return e.next=4,Y("my-profile",{});case 4:t=e.sent,n=t.user,r=t.team,a=t.room,console.log("Receiving: "),this.setUser(n),this.setTeam(r),this.setRoom(a);case 12:e.next=16;break;case 14:e.prev=14,e.t0=e["catch"](0);case 16:case"end":return e.stop()}},e,this,[[0,14]])}));function t(){return e.apply(this,arguments)}return t}(),setUser:function(e){this.store.user=e},setTeam:function(e){this.store.team=e},setRoom:function(e){this.store.room=e},logoutUser:function(){F.a.remove("authToken"),this.$router.push("/login")}},computed:{}}),r["a"].mixin({methods:{moment:ee.a}}),r["a"].config.productionTip=!1,new r["a"]({router:Lt,render:function(e){return e(f)}}).$mount("#app")},"5a20":function(e,t,n){},"5c0b":function(e,t,n){"use strict";var r=n("5e27"),a=n.n(r);a.a},"5e27":function(e,t,n){},"5efa":function(e,t,n){"use strict";var r=n("2e40"),a=n.n(r);a.a},"608a":function(e,t,n){"use strict";var r=n("02c9"),a=n.n(r);a.a},"6cd9":function(e,t,n){"use strict";var r=n("cf5a"),a=n.n(r);a.a},7609:function(e,t,n){"use strict";var r=n("f4f2"),a=n.n(r);a.a},"7d05":function(e,t,n){},a6f0:function(e,t,n){"use strict";var r=n("31f1"),a=n.n(r);a.a},b285:function(e,t,n){"use strict";var r=n("0c2b"),a=n.n(r);a.a},ba23:function(e,t,n){"use strict";var r=n("7d05"),a=n.n(r);a.a},cf5a:function(e,t,n){},ee6b:function(e,t,n){"use strict";var r=n("2db7"),a=n.n(r);a.a},f0bc:function(e,t,n){"use strict";var r=n("5a20"),a=n.n(r);a.a},f4f2:function(e,t,n){}});
//# sourceMappingURL=app.2040f792.js.map